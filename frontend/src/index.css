:root {
    --bg: #000000;
    --panel: #0e0e0f;
    --panel-2: #141416;
    --surface: #ffffff;
    --text: #ffffff;
    --text-on-surface: #0b0b0d;
    --muted: #a8a8b3;
    --primary: #ffffff;
    --radius: 14px;
    --chat-header-space: 56px; /* space reserved at top of the feed */
    --chat-content-width: min(1200px, 98%); /* shared width for messages and composer */
  }
  
  * { box-sizing: border-box }
  
  html, body, #root {
    height: 100%;
  }
  
  body {
    margin: 0;
    color: var(--text);
    background: var(--bg);
    font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    overflow: hidden; /* prevent page scroll; use in-app scroll containers */
  }
  
  .app {
    height: 100%;
    display: grid;
    grid-template-columns: 320px 1fr; /* left nav | chat */
    gap: 0;
    transition: grid-template-columns 220ms ease;
    overflow: hidden; /* prevent app grid from scrolling */
  }
  .app.app--nav-collapsed { grid-template-columns: 64px 1fr }
  /* Collapsed behaviors for left nav */
  .left-nav.left-nav--collapsed .brand__text--full { display: none }
  .left-nav:not(.left-nav--collapsed) .brand__text--compact { display: none }
  .left-nav.left-nav--collapsed .left-nav__label { display: none }
  .left-nav.left-nav--collapsed .left-nav__scroll { display: none }
  .left-nav.left-nav--collapsed .left-nav__actions { display: none }
  .left-nav:not(.left-nav--collapsed) .left-nav__rail { display: none }
  
  /* Chat window */
  .chat-window {
    position: relative;
    display: flex;
    flex-direction: column;
    padding: 12px clamp(16px, 4vw, 40px);
    height: 100%;
    overflow: hidden; /* confine scrolling to internal containers */
  }
  
  /* First-send "wave" animation: a soft radial pulse rising from the composer */
  .chat-window.chat-window--sending::after {
    content: "";
    position: fixed;
    left: 50%;
    bottom: 54px; /* just above bottom padding */
    transform: translateX(-50%);
    width: 20px;
    height: 20px;
    border-radius: 999px;
    pointer-events: none;
    background: radial-gradient(closest-side, rgba(255,255,255,0.55), rgba(255,255,255,0.10) 70%, rgba(255,255,255,0));
    animation: send-wave 800ms ease-out forwards;
    filter: blur(2px);
  }
  
  @keyframes send-wave {
    0% { opacity: 0.6; transform: translateX(-50%) translateY(0) scale(1); }
    60% { opacity: 0.25; transform: translateX(-50%) translateY(-80px) scale(10); }
    100% { opacity: 0; transform: translateX(-50%) translateY(-110px) scale(14); }
  }
  
  .chat-gradient { display: none }
  
  /* Empty state */
  .empty-hero { position: absolute; inset: 0; display: grid; align-content: center; justify-items: center; grid-auto-rows: min-content; row-gap: 14px; text-align: center; padding: 20px; pointer-events: none }
  /* When entering with the generic fade-in class, slow it down for the hero */
  .empty-hero.fade-in { animation-duration: 720ms; animation-timing-function: cubic-bezier(.2,.7,.2,1) }
  .empty-hero--exit { animation: hero-exit 700ms cubic-bezier(.2,.7,.2,1) forwards }
  @keyframes hero-exit {
    0% { opacity: 1; transform: translateY(0) scale(1) rotate(0deg) }
    20% { opacity: 1; transform: translateY(4px) scale(1.02) }
    60% { opacity: 0.55; transform: translateY(-10px) scale(0.98) }
    100% { opacity: 0; transform: translateY(-24px) scale(0.92) }
  }
  :root {
    --bg: #000000;
    --panel: #0e0e0f;
    --panel-2: #141416;
    --surface: #ffffff;
    --text: #ffffff;
    --text-on-surface: #0b0b0d;
    --muted: #a8a8b3;
    --primary: #ffffff;
    --radius: 14px;
    --chat-header-space: 56px; /* space reserved at top of the feed */
    --chat-content-width: min(1200px, 98%); /* shared width for messages and composer */
  }
  
  * { box-sizing: border-box }
  
  html, body, #root {
    height: 100%;
  }
  
  body {
    margin: 0;
    color: var(--text);
    background: var(--bg);
    font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    overflow: hidden; /* prevent page scroll; use in-app scroll containers */
  }
  
  .app {
    height: 100%;
    display: grid;
    grid-template-columns: 320px 1fr; /* left nav | chat */
    gap: 0;
    transition: grid-template-columns 220ms ease;
    overflow: hidden; /* prevent app grid from scrolling */
  }
  .app.app--nav-collapsed { grid-template-columns: 64px 1fr }
  /* Collapsed behaviors for left nav */
  .left-nav.left-nav--collapsed .brand__text--full { display: none }
  .left-nav:not(.left-nav--collapsed) .brand__text--compact { display: none }
  .left-nav.left-nav--collapsed .left-nav__label { display: none }
  .left-nav.left-nav--collapsed .left-nav__scroll { display: none }
  .left-nav.left-nav--collapsed .left-nav__actions { display: none }
  .left-nav:not(.left-nav--collapsed) .left-nav__rail { display: none }
  
  /* Chat window */
  .chat-window {
    position: relative;
    display: flex;
    flex-direction: column;
    padding: 12px clamp(16px, 4vw, 40px);
    height: 100%;
    overflow: hidden; /* confine scrolling to internal containers */
  }
  
  /* First-send "wave" animation: a soft radial pulse rising from the composer */
  .chat-window.chat-window--sending::after {
    content: "";
    position: fixed;
    left: 50%;
    bottom: 54px; /* just above bottom padding */
    transform: translateX(-50%);
    width: 20px;
    height: 20px;
    border-radius: 999px;
    pointer-events: none;
    background: radial-gradient(closest-side, rgba(255,255,255,0.55), rgba(255,255,255,0.10) 70%, rgba(255,255,255,0));
    animation: send-wave 800ms ease-out forwards;
    filter: blur(2px);
  }
  
  @keyframes send-wave {
    0% { opacity: 0.6; transform: translateX(-50%) translateY(0) scale(1); }
    60% { opacity: 0.25; transform: translateX(-50%) translateY(-80px) scale(10); }
    100% { opacity: 0; transform: translateX(-50%) translateY(-110px) scale(14); }
  }
  
  .chat-gradient { display: none }
  
  /* Empty state */
  .empty-hero { position: absolute; inset: 0; display: grid; align-content: center; justify-items: center; grid-auto-rows: min-content; row-gap: 14px; text-align: center; padding: 20px; pointer-events: none }
  /* When entering with the generic fade-in class, slow it down for the hero */
  .empty-hero.fade-in { animation-duration: 720ms; animation-timing-function: cubic-bezier(.2,.7,.2,1) }
  .empty-hero--exit { animation: hero-exit 700ms cubic-bezier(.2,.7,.2,1) forwards }
  @keyframes hero-exit {
    0% { opacity: 1; transform: translateY(0) scale(1) rotate(0deg) }
    20% { opacity: 1; transform: translateY(4px) scale(1.02) }
    60% { opacity: 0.55; transform: translateY(-10px) scale(0.98) }
    100% { opacity: 0; transform: translateY(-24px) scale(0.92) }
  }
  .empty-hero__light {
    position: absolute;
    top: 8px;
    left: 50%;
    transform: translateX(-50%);
    width: min(760px, 88vw);
    height: 200px;
    background: radial-gradient(
      ellipse at 50% 0%,
      rgba(255,255,255,0.66),
      rgba(255,255,255,0.16) 55%,
      rgba(255,255,255,0.00) 72%
    );
    filter: blur(12px);
    opacity: 0; /* ramp-in via animation for a smoother reveal */
    pointer-events: none;
    z-index: 4; /* ensure the highlight appears above background and below content */
    will-change: opacity, transform, filter;
    animation: hero-light-in 1400ms cubic-bezier(.2,.7,.2,1) 60ms forwards;
  }
  /* Thin highlight line to sell the light source */
.empty-hero__light { position: absolute;
   top: 10px;
  left: 50%; 
  transform: translateX(-60%); width: min(760px, 98vw); height: 200px; background: radial-gradient(ellipse at 50% 00%, rgba(255,255,255,0.45), rgba(255,255,255,0.12) 50%, rgba(255,255,255,0.00) 100%); filter: blur(10px); opacity: 0.25; pointer-events: none; z-index: 2; clip-path: polygon(15% 0, 85% 0, 100% 100%, 0% 100%); }
  @keyframes hero-light-in {
    0%   { opacity: 0; transform: translateX(-50%) translateY(-6px) scaleY(0.96); filter: blur(14px); }
    60%  { opacity: 0.88; transform: translateX(-50%) translateY(0) scaleY(1); filter: blur(12px); }
    100% { opacity: 0.92; transform: translateX(-50%) translateY(0) scaleY(1); filter: blur(10px); }
  }
  @keyframes hero-light-line {
    0%   { opacity: 0; filter: blur(4px); }
    40%  { opacity: 0.85; filter: blur(2px); }
    100% { opacity: 0.9; filter: blur(2px); }
  }
  .empty-hero__title {
    font-family: 'Playfair Display', Georgia, 'Times New Roman', serif;
    font-weight: 900;
    letter-spacing: 0.4px;
    font-size: clamp(28px, 5.6vw, 64px);
    margin: 0 0 0px;
    text-shadow: 0 1px 0 rgba(255,255,255,0.06);
    display: inline-flex;
    align-items: baseline;
    gap: 10px;
    justify-self: center;
    opacity: 0;
    transform: translateY(8px);
    animation: hero-title-in 900ms cubic-bezier(.2,.7,.2,1) 140ms forwards;
  }
  .empty-hero__title .slash { opacity: 0.5; margin: 0 10px }
  .empty-hero__note { font-weight: 600; opacity: 0.8; font-size: clamp(18px, 2.6vw, 28px) }
  .empty-hero__subtitle {
    color: var(--muted);
    max-width: 820px;
    margin: 0 auto 16px;
    font-size: clamp(14px, 2.2vw, 16px);
    opacity: 0;
    transform: translateY(10px);
    animation: hero-subtitle-in 1100ms cubic-bezier(.2,.7,.2,1) 260ms forwards;
  }
  @keyframes hero-title-in {
    to { opacity: 1; transform: translateY(0) }
  }
  @keyframes hero-subtitle-in {
    to { opacity: 1; transform: translateY(0) }
  }
  .empty-hero__chips { display: flex; gap: 8px; justify-content: center; flex-wrap: wrap }
  .chip {
    border: 1px solid rgba(255,255,255,0.14);
    background: #111114;
    color: var(--text);
    border-radius: 999px;
    padding: 8px 12px;
    cursor: pointer;
  }
  .chip:hover { background: rgba(255,255,255,0.08) }
  
  .btn--primary { background: linear-gradient(180deg, #ffffff, #e9e9e9); color: #0b0b0d; border-color: rgba(255,255,255,0.2) }
  .btn--primary:hover { filter: brightness(0.97) }
  
  .fade-in { animation: fade-in 320ms ease both }
  @keyframes fade-in {
    from { opacity: 0; transform: translateY(6px) }
    to { opacity: 1; transform: translateY(0) }
  }
  
  .chat-header {
    position: sticky;
    top: 0;
    z-index: 1; /* allow hero light to glow above while header remains interactive */
    padding: 6px 0 10px;
    min-height: var(--chat-header-space);
    background: transparent;
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
  }
  .chat-header__inner { display: flex; align-items: center; justify-content: space-between; gap: 12px }
  .model-select {
    height: 34px;
    padding: 0 34px 0 12px; /* right space for custom chevron */
    border-radius: 10px;
    border: none;
    background-color: #111114 !important; /* enforce on Linux */
    color: var(--text) !important;
    outline: none;
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    cursor: pointer;
    color-scheme: dark;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 10px center;
  }
  .model-select option { background: #111114; color: var(--text) }
  .model-select:focus-visible { box-shadow: 0 0 0 3px rgba(255,255,255,0.14) }
  .save-button { height: 34px; padding: 0 12px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.12); background: #121214; color: var(--text); cursor: pointer }
  .save-button:hover { background: rgba(255,255,255,0.08) }
  
  /* Scrollable message feed with breathing space at sides */
  .message-list {
    list-style: none;
    margin: 0;
    padding: calc(var(--chat-header-space) + 8px) 0 180px 0; /* header space + generous composer space for auto-grow */
    overflow-y: auto;
    align-self: center;
    width: var(--chat-content-width);
    flex: 1 1 auto;
    min-height: 0;
    overscroll-behavior: contain;
    -ms-overflow-style: none; /* IE/Edge */
    scrollbar-width: none; /* Firefox */
    position: relative;
    z-index: 3; /* ensure messages are above header visuals */
  }
  .message-list::-webkit-scrollbar { width: 0; height: 0 } /* Chrome/Safari */
  
  .message {
    display: flex;
    margin: 12px 0;
  }
  .message--user { justify-content: flex-end }
  
  .message__bubble {
    max-width: min(720px, 80%);
    padding: 12px 16px;
    border-radius: 14px;
    line-height: 1.5;
    background: #111214; /* default; overridden per role */
    border: 1px solid rgba(255,255,255,0.10);
    box-shadow: 0 6px 20px rgba(0,0,0,0.28), inset 0 1px 0 rgba(255,255,255,0.04);
    white-space: pre-wrap; /* preserve user-entered newlines */
    overflow-wrap: anywhere; /* break long tokens/URLs */
    word-break: break-word; /* safety for extreme strings */
  }
  
  /* Assistant: no bubble look */
  .message--assistant .message__bubble {
    background: transparent;
    border: none;
    box-shadow: none;
    padding: 0;
    border-radius: 0;
    color: var(--text);
  }
  
  /* User: dark grey bubble with readable text */
  .message--user .message__bubble {
    background: #1b1c20;
    color: var(--text);
    border-color: rgba(255,255,255,0.14);
  }
  
  .composer {
    position: sticky;
    bottom: 0;
    margin-top: auto;
    display: grid;
    grid-template-columns: 1fr; /* single column; children control their own width */
    grid-template-rows: auto auto; /* allow input row to grow with textarea */
    grid-template-areas:
      "prompts"
      "input";
    gap: 10px;
    padding: 14px;
    background: var(--bg);
  }
  
  /* Prompt bar now lives inside the composer, directly above the input */
  .prompt-bar {
    grid-area: prompts;
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    justify-content: center;
    padding: 0 0 2px;
    width: min(980px, 98%);
    justify-self: center;
  }
  .prompt-bar--exit { animation: prompt-exit 500ms ease forwards }
  @keyframes prompt-exit {
    0% { opacity: 1; transform: translateY(0) }
    100% { opacity: 0; transform: translateY(8px) }
  }
  
  .composer__input { grid-area: input }
  .composer__send { grid-area: input }
  
  /* Input field wrapper to place the send button inside */
  .composer__field {
    grid-area: input;
    position: relative;
    width: var(--chat-content-width);
    justify-self: center;
  }
  
  /* Two-row input box: top is editor (scrollable), bottom is toolbar */
  .composer__box {
    border-radius: var(--radius);
    border: 1px solid rgba(255,255,255,0.08);
    background: #0f0f10;
    color: var(--text);
    display: grid;
    grid-template-rows: 1fr auto;
  }
  
  .composer__editor {
    max-height: 180px;
    overflow: auto; /* scroll text area independently */
    /* Hide scrollbars while keeping scroll */
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE/Edge */
  }
  .composer__editor::-webkit-scrollbar { width: 0; height: 0 }
  
  .composer__textarea {
    width: 100%;
    min-height: 64px;
    border: none;
    outline: none;
    background: transparent;
    color: inherit;
    font: inherit;
    resize: none;
    line-height: 1.45;
    padding: 14px 16px 14px 16px;
    display: block;
    overflow: hidden; /* prevent native scrollbar on textarea */
  }
  .composer__textarea::placeholder { color: var(--muted) }
  .composer__textarea:focus,
  .composer__textarea:focus-visible {
    outline: none;
    box-shadow: none;
  }
  
  .composer__bottom {
    display: flex;
    align-items: center;
    gap: 12px; /* more space between buttons */
    padding: 10px 12px; /* comfortable padding */
    border-top: none; /* remove divider line between editor and buttons */
  }
  
  .composer__input {
    min-height: 96px; /* a bit higher by default */
    max-height: 180px; /* match JS clamp */
    border-radius: var(--radius);
    border: 1px solid rgba(255,255,255,0.08);
    padding: 12px 58px 48px 16px; /* reserve space at bottom for toolbar inside box */
    background: #0f0f10;
    color: var(--text);
    outline: none;
    transition: border-color 160ms ease, box-shadow 160ms ease, background 160ms ease;
    line-height: 1.45;
    resize: none; /* growth is controlled programmatically */
    overflow-y: auto; /* scroll when exceeding max height */
    font: inherit; /* keep app font and size consistent */
    width: 100%;
    display: block;
  }
  .composer__toolbar { display: none }
  .composer__toolbar--exit { display: none }
  
  .composer__tool,
  .composer__icon-button {
    height: 28px;
    min-width: 28px;
    display: grid;
    place-items: center;
    border-radius: 8px;
    border: 1px solid rgba(255,255,255,0.10);
    background: #151519;
    color: var(--text);
    cursor: pointer;
  }
  .composer__tool:hover,
  .composer__icon-button:hover { background: rgba(255,255,255,0.06) }
  
  .composer__chips {
    display: flex;
    align-items: center;
    gap: 6px;
    flex-wrap: nowrap;
    overflow: hidden;
  }
  .chip--small { padding: 6px 10px; font-size: 12px }
  .composer__spacer { flex: 1 1 auto }
  .composer__input::placeholder { color: var(--muted) }
  /* Custom focus ring for input to avoid default blue outline */
  .composer__input:focus,
  .composer__input:focus-visible {
    border-color: inherit;
    box-shadow: none;
  }
  
  .composer__send {
    height: 36px;
    width: 36px;
    aspect-ratio: 1 / 1;
    border-radius: 999px;
    border: 0;
    background: linear-gradient(180deg, #ffffff, #e9e9e9);
    color: #0b0b0d;
    display: grid;
    place-items: center;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(0,0,0,0.32), inset 0 -1px 0 rgba(0,0,0,0.08);
    transition: transform 140ms ease, box-shadow 140ms ease, filter 140ms ease;
    margin-left: auto;
  }
  .composer__send:hover {
    transform: translateY(-1px);
    filter: brightness(0.98);
  }
  .composer__send:active {
    transform: translateY(0) scale(0.98);
  }
  .composer__send:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px rgba(255,255,255,0.25), 0 6px 18px rgba(0,0,0,0.35);
  }
  .composer__send svg { width: 16px; height: 16px; transform: none }
  
  /* Hide native scrollbar visuals in textarea while retaining scrollability */
  .composer__input::-webkit-scrollbar { width: 0; height: 0 }
  .composer__input { scrollbar-width: none; -ms-overflow-style: none }
  
  /* Left navigator */
  .left-nav {
    height: 100%;
    border-right: 1px solid rgba(255,255,255,0.1);
    background: #0b0b0d;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    transition: width 220ms ease, opacity 220ms ease;
  }
  .left-nav__scroll { flex: 1 1 auto; min-height: 0; overflow-y: auto; overflow-x: hidden; padding-bottom: 8px; overscroll-behavior: contain; -ms-overflow-style: none; scrollbar-width: none }
  .left-nav__scroll::-webkit-scrollbar { width: 0; height: 0 }
  /* Keep top/bottom from stretching */
  .left-nav__top { flex: 0 0 auto }
  /* Toggle aligned to the right; lock to content height and push to bottom using auto margin */
  .left-nav__bottom { padding: 10px 14px; border-top: 1px solid rgba(255,255,255,0.08); display: flex; justify-content: flex-end; background: #0b0b0d; flex: 0 0 auto; margin-top: auto; position: static }
  /* Arrow-only shrinker */
  .dock-toggle { width: 28px; height: 28px; border-radius: 0; border: none; background: transparent; color: var(--text); display: grid; place-items: center; cursor: pointer; padding: 0 }
  .dock-toggle:hover { background: transparent; opacity: 0.85 }
  
  .left-nav__top {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 14px 14px 24px 14px; /* add more space below actions */
  }
  
  .brand { display: flex; gap: 8px; align-items: center; font-weight: 700 }
  .brand__logo { width: 55px; height: 55px; display: block; transform: translatey(5px);}
  .brand__text { letter-spacing: 0.3px }
  
  .left-nav__actions { display: flex; gap: 8px }
  /* Collapsed vertical rail */
  .left-nav__rail { display: flex; flex-direction: column; gap: 8px }
  .left-nav.left-nav--collapsed .brand { gap: 6px }
  /* extra vertical spacing under brand in collapsed mode */
  .left-nav.left-nav--collapsed .left-nav__rail { margin-top: 6px }
  .left-nav .left-nav__rail { margin-top: 4px }
  .left-nav.left-nav--collapsed .left-nav__top { flex-direction: column; align-items: center; gap: 10px }
  .left-nav.left-nav--collapsed .brand { flex-direction: column }
  .icon-button {
    width: 36px;
    height: 36px;
    display: grid;
    place-items: center;
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.08);
    background: #121214;
    color: var(--text);
    cursor: pointer;
  }
  .icon-button:hover { background: rgba(255,255,255,0.07) }
  
  .left-nav__label {
    color: var(--muted);
    font-size: 12px;
    padding: 6px 14px;
    margin-top: 6px; /* gap between action icons and label */
    text-transform: uppercase;
    letter-spacing: 0.08em;
  }
  
  .conversation-list {
    list-style: none;
    margin: 0;
    padding: 8px;
    overflow: visible;
  }
  
  .conversation {
    width: 100%;
    display: flex;
    gap: 10px;
    align-items: center;
    text-align: left;
    padding: 10px;
    border-radius: 12px;
    border: 1px solid transparent;
    background: transparent;
    color: var(--text);
    cursor: pointer;
  }
  .conversation:hover {
    background: rgba(255,255,255,0.04);
    border-color: rgba(255,255,255,0.06);
  }
  .conversation--active { background: #151517; border-color: rgba(255,255,255,0.12) }
  .conversation__icon { display: grid; place-items: center; color: var(--muted) }
  .conversation__meta { display: flex; flex-direction: column; min-width: 0; flex: 1 }
  .conversation__title { font-size: 14px; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis }
  .conversation__input {
    border: none;
    outline: none;
    background: transparent;
    color: inherit;
    font: inherit;
    padding: 0;
  }
  
  .conversation__main {
    display: flex;
    align-items: center;
    gap: 10px;
    flex: 1;
    background: transparent;
    border: none;
    color: inherit;
    cursor: pointer;
    text-align: left;
  }
  
  .conversation__menu { position: relative; margin-left: auto }
  .menu-trigger {
    width: 28px;
    height: 28px;
    display: grid;
    place-items: center;
    border-radius: 8px;
    border: none;
    background: transparent;
    color: var(--text);
    cursor: pointer;
  }
  .conversation__menu .menu {
    display: none;
    position: absolute;
    right: 0;
    top: 32px;
    min-width: 140px;
    padding: 6px;
    border-radius: 10px;
    background: #0f0f10;
    border: 1px solid rgba(255,255,255,0.12);
    box-shadow: 0 8px 30px rgba(0,0,0,0.35);
    z-index: 10;
  }
  .conversation__menu.open .menu { display: block }
  .conversation__menu .menu button {
    width: 100%;
    height: 30px;
    background: transparent;
    border: none;
    color: var(--text);
    text-align: left;
    border-radius: 8px;
    padding: 0 8px;
  }
  .conversation__menu .menu button:hover {
    background: rgba(255,255,255,0.06);
  }
  
  /* Folder styles */
  .folder { margin: 8px 0; padding: 8px; border-radius: 10px; background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.10) }
  .folder--selected { border-color: rgba(255,255,255,0.35); background: rgba(255,255,255,0.03) }
  .folder__header { display: flex; align-items: center; gap: 8px; color: var(--muted); font-size: 12px; padding: 4px 2px 8px 2px; text-transform: uppercase; letter-spacing: 0.06em }
  .folder__icon { display: grid; place-items: center }
  .folder__title { font-weight: 600 }
  .folder__input {
    height: auto;
    border: none;
    outline: none;
    background: transparent;
    color: inherit;
    padding: 0;
    font: inherit;
    width: 100%;
  }
  
  .context-menu {
    position: fixed;
    z-index: 1000;
    min-width: 160px;
    padding: 6px;
    border-radius: 10px;
    background: #0f0f10;
    border: 1px solid rgba(255,255,255,0.12);
    box-shadow: 0 8px 30px rgba(0,0,0,0.35);
  }
  .context-menu__item {
    width: 100%;
    height: 30px;
    background: transparent;
    border: none;
    color: var(--text);
    text-align: left;
    border-radius: 8px;
    padding: 0 10px;
    cursor: pointer;
  }
  .context-menu__item:hover { background: rgba(255,255,255,0.06) }
  
  .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: grid; place-items: center; z-index: 1100 }
  .modal { width: min(480px, 92vw); border-radius: 14px; background: #0f0f10; border: 1px solid rgba(255,255,255,0.12); box-shadow: 0 20px 60px rgba(0,0,0,0.5); padding: 18px }
  .modal__header { font-weight: 700; margin-bottom: 10px }
  .modal__body { color: var(--muted); margin-bottom: 16px; line-height: 1.5 }
  .modal__actions { display: flex; justify-content: flex-end; gap: 8px }
  .btn { height: 34px; padding: 0 12px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.12); background: #121214; color: var(--text); cursor: pointer }
  .btn--ghost { background: transparent; border-color: rgba(255,255,255,0.16) }
  .btn--danger { background: #d93c3c; border-color: #d93c3c; color: white }
  .btn--danger:hover { filter: brightness(0.95) }
  
  .select {
    width: 100%;
    height: 32px;
    border-radius: 8px;
    border: 1px solid rgba(255,255,255,0.12);
    background: #111114;
    color: var(--text);
  }
  
  @media (max-width: 900px) {
    .app { grid-template-columns: 1fr } /* hide left-nav on mobile */
    .left-nav { display: none }
  }
  
  /* Thin highlight line to sell the light source */
  .empty-hero__light::before {
    content: "";
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 98%;
    height: 2px;
    background: linear-gradient(90deg, rgba(255,255,255,0), rgba(255,255,255,1), rgba(255,255,255,0));
    box-shadow: 0 0 18px rgba(255,255,255,0.95), 0 0 36px rgba(255,255,255,0.55);
    opacity: 0;
    will-change: opacity, filter;
    animation: hero-light-line 1600ms ease-out 180ms forwards;
  }
  @keyframes hero-light-in {
    0%   { opacity: 0; transform: translateX(-50%) translateY(-6px) scaleY(0.96); filter: blur(14px); }
    60%  { opacity: 0.88; transform: translateX(-50%) translateY(0) scaleY(1); filter: blur(12px); }
    100% { opacity: 0.92; transform: translateX(-50%) translateY(0) scaleY(1); filter: blur(10px); }
  }
  @keyframes hero-light-line {
    0%   { opacity: 0; filter: blur(4px); }
    40%  { opacity: 0.85; filter: blur(2px); }
    100% { opacity: 0.9; filter: blur(2px); }
  }
  .empty-hero__title {
    font-family: 'Playfair Display', Georgia, 'Times New Roman', serif;
    font-weight: 900;
    letter-spacing: 0.4px;
    font-size: clamp(28px, 5.6vw, 64px);
    margin: 0 0 0px;
    text-shadow: 0 1px 0 rgba(255,255,255,0.06);
    display: inline-flex;
    align-items: baseline;
    gap: 10px;
    justify-self: center;
    opacity: 0;
    transform: translateY(8px);
    animation: hero-title-in 900ms cubic-bezier(.2,.7,.2,1) 140ms forwards;
  }
  .empty-hero__title .slash { opacity: 0.5; margin: 0 10px }
  .empty-hero__note { font-weight: 600; opacity: 0.8; font-size: clamp(18px, 2.6vw, 28px) }
  .empty-hero__subtitle {
    color: var(--muted);
    max-width: 820px;
    margin: 0 auto 16px;
    font-size: clamp(14px, 2.2vw, 16px);
    opacity: 0;
    transform: translateY(10px);
    animation: hero-subtitle-in 1100ms cubic-bezier(.2,.7,.2,1) 260ms forwards;
  }
  @keyframes hero-title-in {
    to { opacity: 1; transform: translateY(0) }
  }
  @keyframes hero-subtitle-in {
    to { opacity: 1; transform: translateY(0) }
  }
  .empty-hero__chips { display: flex; gap: 8px; justify-content: center; flex-wrap: wrap }
  .chip {
    border: 1px solid rgba(255,255,255,0.14);
    background: #111114;
    color: var(--text);
    border-radius: 999px;
    padding: 8px 12px;
    cursor: pointer;
  }
  .chip:hover { background: rgba(255,255,255,0.08) }
  
  .btn--primary { background: linear-gradient(180deg, #ffffff, #e9e9e9); color: #0b0b0d; border-color: rgba(255,255,255,0.2) }
  .btn--primary:hover { filter: brightness(0.97) }
  
  .fade-in { animation: fade-in 320ms ease both }
  @keyframes fade-in {
    from { opacity: 0; transform: translateY(6px) }
    to { opacity: 1; transform: translateY(0) }
  }
  
  .chat-header {
    position: sticky;
    top: 0;
    z-index: 1; /* allow hero light to glow above while header remains interactive */
    padding: 6px 0 10px;
    min-height: var(--chat-header-space);
    background: transparent;
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
  }
  .chat-header__inner { display: flex; align-items: center; justify-content: space-between; gap: 12px }
  .model-select {
    height: 34px;
    padding: 0 34px 0 12px; /* right space for custom chevron */
    border-radius: 10px;
    border: none;
    background-color: #111114 !important; /* enforce on Linux */
    color: var(--text) !important;
    outline: none;
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    cursor: pointer;
    color-scheme: dark;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 10px center;
  }
  .model-select option { background: #111114; color: var(--text) }
  .model-select:focus-visible { box-shadow: 0 0 0 3px rgba(255,255,255,0.14) }
  .save-button { height: 34px; padding: 0 12px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.12); background: #121214; color: var(--text); cursor: pointer }
  .save-button:hover { background: rgba(255,255,255,0.08) }
  
  /* Scrollable message feed with breathing space at sides */
  .message-list {
    list-style: none;
    margin: 0;
    padding: calc(var(--chat-header-space) + 8px) 0 180px 0; /* header space + generous composer space for auto-grow */
    overflow-y: auto;
    align-self: center;
    width: var(--chat-content-width);
    flex: 1 1 auto;
    min-height: 0;
    overscroll-behavior: contain;
    -ms-overflow-style: none; /* IE/Edge */
    scrollbar-width: none; /* Firefox */
    position: relative;
    z-index: 3; /* ensure messages are above header visuals */
  }
  .message-list::-webkit-scrollbar { width: 0; height: 0 } /* Chrome/Safari */
  
  .message {
    display: flex;
    margin: 12px 0;
  }
  .message--user { justify-content: flex-end }
  
  .message__bubble {
    max-width: min(720px, 80%);
    padding: 12px 16px;
    border-radius: 14px;
    line-height: 1.5;
    background: #111214; /* default; overridden per role */
    border: 1px solid rgba(255,255,255,0.10);
    box-shadow: 0 6px 20px rgba(0,0,0,0.28), inset 0 1px 0 rgba(255,255,255,0.04);
    white-space: pre-wrap; /* preserve user-entered newlines */
    overflow-wrap: anywhere; /* break long tokens/URLs */
    word-break: break-word; /* safety for extreme strings */
  }
  
  /* Assistant: no bubble look */
  .message--assistant .message__bubble {
    background: transparent;
    border: none;
    box-shadow: none;
    padding: 0;
    border-radius: 0;
    color: var(--text);
  }
  
  /* User: dark grey bubble with readable text */
  .message--user .message__bubble {
    background: #1b1c20;
    color: var(--text);
    border-color: rgba(255,255,255,0.14);
  }
  
  .composer {
    position: sticky;
    bottom: 0;
    margin-top: auto;
    display: grid;
    grid-template-columns: 1fr; /* single column; children control their own width */
    grid-template-rows: auto auto; /* allow input row to grow with textarea */
    grid-template-areas:
      "prompts"
      "input";
    gap: 10px;
    padding: 14px;
    background: var(--bg);
  }
  
  /* Prompt bar now lives inside the composer, directly above the input */
  .prompt-bar {
    grid-area: prompts;
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    justify-content: center;
    padding: 0 0 2px;
    width: min(980px, 98%);
    justify-self: center;
  }
  .prompt-bar--exit { animation: prompt-exit 500ms ease forwards }
  @keyframes prompt-exit {
    0% { opacity: 1; transform: translateY(0) }
    100% { opacity: 0; transform: translateY(8px) }
  }
  
  .composer__input { grid-area: input }
  .composer__send { grid-area: input }
  
  /* Input field wrapper to place the send button inside */
  .composer__field {
    grid-area: input;
    position: relative;
    width: var(--chat-content-width);
    justify-self: center;
  }
  
  /* Two-row input box: top is editor (scrollable), bottom is toolbar */
  .composer__box {
    border-radius: var(--radius);
    border: 1px solid rgba(255,255,255,0.08);
    background: #0f0f10;
    color: var(--text);
    display: grid;
    grid-template-rows: 1fr auto;
  }
  
  .composer__editor {
    max-height: 180px;
    overflow: auto; /* scroll text area independently */
    /* Hide scrollbars while keeping scroll */
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE/Edge */
  }
  .composer__editor::-webkit-scrollbar { width: 0; height: 0 }
  
  .composer__textarea {
    width: 100%;
    min-height: 64px;
    border: none;
    outline: none;
    background: transparent;
    color: inherit;
    font: inherit;
    resize: none;
    line-height: 1.45;
    padding: 14px 16px 14px 16px;
    display: block;
    overflow: hidden; /* prevent native scrollbar on textarea */
  }
  .composer__textarea::placeholder { color: var(--muted) }
  .composer__textarea:focus,
  .composer__textarea:focus-visible {
    outline: none;
    box-shadow: none;
  }
  
  .composer__bottom {
    display: flex;
    align-items: center;
    gap: 12px; /* more space between buttons */
    padding: 10px 12px; /* comfortable padding */
    border-top: none; /* remove divider line between editor and buttons */
  }
  
  .composer__input {
    min-height: 96px; /* a bit higher by default */
    max-height: 180px; /* match JS clamp */
    border-radius: var(--radius);
    border: 1px solid rgba(255,255,255,0.08);
    padding: 12px 58px 48px 16px; /* reserve space at bottom for toolbar inside box */
    background: #0f0f10;
    color: var(--text);
    outline: none;
    transition: border-color 160ms ease, box-shadow 160ms ease, background 160ms ease;
    line-height: 1.45;
    resize: none; /* growth is controlled programmatically */
    overflow-y: auto; /* scroll when exceeding max height */
    font: inherit; /* keep app font and size consistent */
    width: 100%;
    display: block;
  }
  .composer__toolbar { display: none }
  .composer__toolbar--exit { display: none }
  
  .composer__tool,
  .composer__icon-button {
    height: 28px;
    min-width: 28px;
    display: grid;
    place-items: center;
    border-radius: 8px;
    border: 1px solid rgba(255,255,255,0.10);
    background: #151519;
    color: var(--text);
    cursor: pointer;
  }
  .composer__tool:hover,
  .composer__icon-button:hover { background: rgba(255,255,255,0.06) }
  
  .composer__chips {
    display: flex;
    align-items: center;
    gap: 6px;
    flex-wrap: nowrap;
    overflow: hidden;
  }
  .chip--small { padding: 6px 10px; font-size: 12px }
  .composer__spacer { flex: 1 1 auto }
  .composer__input::placeholder { color: var(--muted) }
  /* Custom focus ring for input to avoid default blue outline */
  .composer__input:focus,
  .composer__input:focus-visible {
    border-color: inherit;
    box-shadow: none;
  }
  
  .composer__send {
    height: 36px;
    width: 36px;
    aspect-ratio: 1 / 1;
    border-radius: 999px;
    border: 0;
    background: linear-gradient(180deg, #ffffff, #e9e9e9);
    color: #0b0b0d;
    display: grid;
    place-items: center;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(0,0,0,0.32), inset 0 -1px 0 rgba(0,0,0,0.08);
    transition: transform 140ms ease, box-shadow 140ms ease, filter 140ms ease;
    margin-left: auto;
  }
  .composer__send:hover {
    transform: translateY(-1px);
    filter: brightness(0.98);
  }
  .composer__send:active {
    transform: translateY(0) scale(0.98);
  }
  .composer__send:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px rgba(255,255,255,0.25), 0 6px 18px rgba(0,0,0,0.35);
  }
  .composer__send svg { width: 16px; height: 16px; transform: none }
  
  /* Hide native scrollbar visuals in textarea while retaining scrollability */
  .composer__input::-webkit-scrollbar { width: 0; height: 0 }
  .composer__input { scrollbar-width: none; -ms-overflow-style: none }
  
  /* Left navigator */
  .left-nav {
    height: 100%;
    border-right: 1px solid rgba(255,255,255,0.1);
    background: #0b0b0d;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    transition: width 220ms ease, opacity 220ms ease;
  }
  .left-nav__scroll { flex: 1 1 auto; min-height: 0; overflow-y: auto; overflow-x: hidden; padding-bottom: 8px; overscroll-behavior: contain; -ms-overflow-style: none; scrollbar-width: none }
  .left-nav__scroll::-webkit-scrollbar { width: 0; height: 0 }
  /* Keep top/bottom from stretching */
  .left-nav__top { flex: 0 0 auto }
  /* Toggle aligned to the right; lock to content height and push to bottom using auto margin */
  .left-nav__bottom { padding: 10px 14px; border-top: 1px solid rgba(255,255,255,0.08); display: flex; justify-content: flex-end; background: #0b0b0d; flex: 0 0 auto; margin-top: auto; position: static }
  /* Arrow-only shrinker */
  .dock-toggle { width: 28px; height: 28px; border-radius: 0; border: none; background: transparent; color: var(--text); display: grid; place-items: center; cursor: pointer; padding: 0 }
  .dock-toggle:hover { background: transparent; opacity: 0.85 }
  
  .left-nav__top {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 14px 14px 24px 14px; /* add more space below actions */
  }
  
  .brand { display: flex; gap: 8px; align-items: center; font-weight: 700 }
  .brand__logo { width: 55px; height: 55px; display: block; transform: translatey(5px);}
  .brand__text { letter-spacing: 0.3px }
  
  .left-nav__actions { display: flex; gap: 8px }
  /* Collapsed vertical rail */
  .left-nav__rail { display: flex; flex-direction: column; gap: 8px }
  .left-nav.left-nav--collapsed .brand { gap: 6px }
  /* extra vertical spacing under brand in collapsed mode */
  .left-nav.left-nav--collapsed .left-nav__rail { margin-top: 6px }
  .left-nav .left-nav__rail { margin-top: 4px }
  .left-nav.left-nav--collapsed .left-nav__top { flex-direction: column; align-items: center; gap: 10px }
  .left-nav.left-nav--collapsed .brand { flex-direction: column }
  .icon-button {
    width: 36px;
    height: 36px;
    display: grid;
    place-items: center;
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.08);
    background: #121214;
    color: var(--text);
    cursor: pointer;
  }
  .icon-button:hover { background: rgba(255,255,255,0.07) }
  
  .left-nav__label {
    color: var(--muted);
    font-size: 12px;
    padding: 6px 14px;
    margin-top: 6px; /* gap between action icons and label */
    text-transform: uppercase;
    letter-spacing: 0.08em;
  }
  
  .conversation-list {
    list-style: none;
    margin: 0;
    padding: 8px;
    overflow: visible;
  }
  
  .conversation {
    width: 100%;
    display: flex;
    gap: 10px;
    align-items: center;
    text-align: left;
    padding: 10px;
    border-radius: 12px;
    border: 1px solid transparent;
    background: transparent;
    color: var(--text);
    cursor: pointer;
  }
  .conversation:hover {
    background: rgba(255,255,255,0.04);
    border-color: rgba(255,255,255,0.06);
  }
  .conversation--active { background: #151517; border-color: rgba(255,255,255,0.12) }
  .conversation__icon { display: grid; place-items: center; color: var(--muted) }
  .conversation__meta { display: flex; flex-direction: column; min-width: 0; flex: 1 }
  .conversation__title { font-size: 14px; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis }
  .conversation__input {
    border: none;
    outline: none;
    background: transparent;
    color: inherit;
    font: inherit;
    padding: 0;
  }
  
  .conversation__main {
    display: flex;
    align-items: center;
    gap: 10px;
    flex: 1;
    background: transparent;
    border: none;
    color: inherit;
    cursor: pointer;
    text-align: left;
  }
  
  .conversation__menu { position: relative; margin-left: auto }
  .menu-trigger {
    width: 28px;
    height: 28px;
    display: grid;
    place-items: center;
    border-radius: 8px;
    border: none;
    background: transparent;
    color: var(--text);
    cursor: pointer;
  }
  .conversation__menu .menu {
    display: none;
    position: absolute;
    right: 0;
    top: 32px;
    min-width: 140px;
    padding: 6px;
    border-radius: 10px;
    background: #0f0f10;
    border: 1px solid rgba(255,255,255,0.12);
    box-shadow: 0 8px 30px rgba(0,0,0,0.35);
    z-index: 10;
  }
  .conversation__menu.open .menu { display: block }
  .conversation__menu .menu button {
    width: 100%;
    height: 30px;
    background: transparent;
    border: none;
    color: var(--text);
    text-align: left;
    border-radius: 8px;
    padding: 0 8px;
  }
  .conversation__menu .menu button:hover {
    background: rgba(255,255,255,0.06);
  }
  
  /* Folder styles */
  .folder { margin: 8px 0; padding: 8px; border-radius: 10px; background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.10) }
  .folder--selected { border-color: rgba(255,255,255,0.35); background: rgba(255,255,255,0.03) }
  .folder__header { display: flex; align-items: center; gap: 8px; color: var(--muted); font-size: 12px; padding: 4px 2px 8px 2px; text-transform: uppercase; letter-spacing: 0.06em }
  .folder__icon { display: grid; place-items: center }
  .folder__title { font-weight: 600 }
  .folder__input {
    height: auto;
    border: none;
    outline: none;
    background: transparent;
    color: inherit;
    padding: 0;
    font: inherit;
    width: 100%;
  }
  
  .context-menu {
    position: fixed;
    z-index: 1000;
    min-width: 160px;
    padding: 6px;
    border-radius: 10px;
    background: #0f0f10;
    border: 1px solid rgba(255,255,255,0.12);
    box-shadow: 0 8px 30px rgba(0,0,0,0.35);
  }
  .context-menu__item {
    width: 100%;
    height: 30px;
    background: transparent;
    border: none;
    color: var(--text);
    text-align: left;
    border-radius: 8px;
    padding: 0 10px;
    cursor: pointer;
  }
  .context-menu__item:hover { background: rgba(255,255,255,0.06) }
  
  .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: grid; place-items: center; z-index: 1100 }
  .modal { width: min(480px, 92vw); border-radius: 14px; background: #0f0f10; border: 1px solid rgba(255,255,255,0.12); box-shadow: 0 20px 60px rgba(0,0,0,0.5); padding: 18px }
  .modal__header { font-weight: 700; margin-bottom: 10px }
  .modal__body { color: var(--muted); margin-bottom: 16px; line-height: 1.5 }
  .modal__actions { display: flex; justify-content: flex-end; gap: 8px }
  .btn { height: 34px; padding: 0 12px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.12); background: #121214; color: var(--text); cursor: pointer }
  .btn--ghost { background: transparent; border-color: rgba(255,255,255,0.16) }
  .btn--danger { background: #d93c3c; border-color: #d93c3c; color: white }
  .btn--danger:hover { filter: brightness(0.95) }
  
  .select {
    width: 100%;
    height: 32px;
    border-radius: 8px;
    border: 1px solid rgba(255,255,255,0.12);
    background: #111114;
    color: var(--text);
  }
  
  @media (max-width: 900px) {
    .app { grid-template-columns: 1fr } /* hide left-nav on mobile */
    .left-nav { display: none }
  }
  
